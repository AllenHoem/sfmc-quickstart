<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
</head>

<body>

<% include ../partials/header-java.ejs %>

<!-- Tutorial steps -->
<div class="container">

  <p class="mt-3">In this section you will create <strong>two</strong> Java apps that use the <a href="http://salesforce-marketingcloud.github.io/FuelSDK-Java/" target="_blank">Marketing Cloud Java SDK</a>.</p>
  <p class="mt-3">The first app tests the connection to your Marketing Cloud account using your <code>Client ID</code> and <code>Client Secret</code>. The second app connects to your Marketing Cloud account, creates a new contact, sends a test e-mail to the contact and checks status of the e-mail.</p>
  
  <!-- Step 1 -->
  <div class="card mt-3">
    <div class="card-block">
      <div class="card-header text-white" style="background-color: #00AA9E;">Step 3.1: Get an API key for Marketing Cloud</div>
      <div class="card-body">
        <h6 class="card-subtitle mb-3">You need an API key to use the Marketing Cloud Java SDK.</h6>
        <p class="card-text">Follow instructions at <a href="https://developer.salesforce.com/docs/atlas.en-us.noversion.mc-getting-started.meta/mc-getting-started/get-api-key.htm" target="_blank">Get an API key</a> to get the <code>Client ID</code> and <code>Client Secret</code> for your Marketing Cloud account.</p>
        <p class="card-text"><span class="fa fa-exclamation text-warning"></span>&nbsp;You will need your <code>Client ID</code> and <code>Client Secret</code> in the next step.</p>
      </div>
    </div>
  </div>
      
  <!-- Step 2 -->
  <div class="card mt-3">
    <div class="card-block">
      <div class="card-header text-white" style="background-color: #00AA9E;">Step 3.2: The first Java app</div>
      <div class="card-body">
        <h6 class="card-subtitle mb-3">This Java app tests the connection to your Marketing Cloud account using your <code>Client ID</code> and <code>Client Secret</code>.</h6>

        <p class="card-text">You should have a file called <code>App.java</code> in your Maven project located at <code>~/sfmc-java-sample/src/main/java/com/sfmcsamples/App.java</code>. 
        Open this file in your favorite text editor and replace the contents with the code below. Save and close the file.</p>

        <p class="card-text"><span class="fa fa-exclamation text-warning"></span>&nbsp;Remember to replace <code>ClientID</code> and <code>ClientSecret</code> in the Java code below with yours from <strong>Step 1</strong>.</p>
        
        <pre>
          <code class="language-java">
            package com.sfmcsamples;
            import com.exacttarget.fuelsdk.*;
            import com.exacttarget.fuelsdk.internal.*;
            
            public class App 
            {
                public static void main( String[] args )
                {
                    // TODO: Update these variables before you compile & run this sample
                    String clientId = "-- replace me --";
                    String clientSecret = "-- replace me --";
                    String contactEmailAddress = "-- replace me --";
                    String contactFirstName = "-- replace me --";
                    String contactLastName = "-- replace me --";
            
                    try
                    {
                        System.out.println("\nDEMO: Connect to Marketing Cloud, create a contact, create an e-mail, send e-mail and check status.\n");
            
                        // Establish a connection to Marketing Cloud 
                        ETConfiguration configuration = new ETConfiguration();
                        configuration.set("clientId", clientId);
                        configuration.set("clientSecret", clientSecret);
                        ETClient etClient = new ETClient(configuration);
                        System.out.println("\nConnected to Marketing Cloud!");
                    }
                    catch(ETSdkException e)
                    {
                        System.out.println("** Exception: " + e.toString());
                    }
            
                    System.out.println("All done.\n");
                }
            }
          </code>
        </pre>

        <p class="card-text">Run the command below in a Terminal window to Build the project and create a jar package.</p>
        <pre class="command-line" data-user="sanjay" data-host="MacBook">
          <code class="language-bash">
            mvn clean package
          </code>
        </pre>

        <p class="card-text">Run the command below in a Terminal window to run your Java application.</p>
        <pre class="command-line" data-user="sanjay" data-host="MacBook">
          <code class="language-bash">
            mvn exec:java "-Dexec.mainClass=com.sfmcsamples.App"
          </code>
        </pre>
  
        <p class="card-text"><span class="fa fa-star text-success"></span>&nbsp;You have sucessfully created your first Java app that connects to Marketing Cloud!</p>
      </div>
    </div>
  </div>

  <!-- Step 3 -->
  <div class="card mt-3">
    <div class="card-block">
      <div class="card-header text-white" style="background-color: #00AA9E;">Step 3.3: The second Java app</div>
      <div class="card-body">
        <h6 class="card-subtitle mb-3">This Java app connects to your Marketing Cloud account, creates a new contact, sends a test e-mail to the contact and checks status of the e-mail.</h6>

          <p class="card-text">Like you did before, open the file <code>App.java</code> in your favorite text editor and replace the contents with the code below. Save and close the file.</p>
  
          <p class="card-text"><span class="fa fa-exclamation text-warning"></span>&nbsp;Remember to replace <code>ClientID</code> and <code>ClientSecret</code> in the Java code below with yours from <strong>Step 1</strong>.</p>
          
          <pre>
            <code class="language-java">
              package com.sfmcsamples;
              import com.exacttarget.fuelsdk.*;
              import com.exacttarget.fuelsdk.internal.*;
              
              public class App 
              {
                  public static void main( String[] args )
                  {
                      // TODO: Update these variables before you compile & run this sample
                      String clientId = "-- replace me --";
                      String clientSecret = "-- replace me --";
                      String contactEmailAddress = "-- replace me --";
                      String contactFirstName = "-- replace me --";
                      String contactLastName = "-- replace me --";
              
                      try
                      {
                          System.out.println("\nDEMO: Connect to Marketing Cloud, create a contact, create an e-mail, send e-mail and check status.\n");
              
                          // Establish a connection to Marketing Cloud 
                          ETConfiguration configuration = new ETConfiguration();
                          configuration.set("clientId", clientId);
                          configuration.set("clientSecret", clientSecret);
                          ETClient etClient = new ETClient(configuration);
                          System.out.println("\nConnected to Marketing Cloud!");
              
                          // Create a new subscriber. An ETSubscriber object represents an email subscriber in Marketing Cloud.
                          System.out.println("Creating a new subscriber...");
                          ETSubscriber subscriber = new ETSubscriber();
                          subscriber.setClient(etClient);
                          subscriber.setKey("demo-contact");
                          subscriber.setEmailAddress(contactEmailAddress);
                          subscriber.setStatus(ETSubscriber.Status.ACTIVE);
                          subscriber.setPreferredEmailType(ETEmail.Type.HTML);
                          subscriber.setAttributes(java.util.Arrays.asList(new ETProfileAttribute("FirstName", contactFirstName), new ETProfileAttribute("LastName", contactLastName)));
                          ETResponse<ETSubscriber> subscriberResponse = etClient.create(subscriber);
                          if(!subscriberResponse.getResponseCode().equals("OK"))
                          {
                              throw new ETSdkException("** ERROR: could not create a new subscriber: " + subscriberResponse.toString());
                          }
                          System.out.println("Created new subscriber: " + subscriberResponse.getObject().getEmailAddress());
              
                          // Create a new e-mail
                          System.out.println("Creating a new e-mail...");
                          ETEmail etEmail = new ETEmail();
                          etEmail.setKey("demo-email");
                          etEmail.setName("demo-email");
                          etEmail.setSubject("E-mail from Java SDK demo");
                          etEmail.setHtmlBody("<b>What a wonderful world!</b>");
                          etEmail.setTextBody("What a wonderful world!");
                          ETResponse<ETEmail> emailResponse = etClient.create(etEmail);
                          if(!emailResponse.getResponseCode().equals("OK"))
                          {
                              throw new ETSdkException("** ERROR: could not create a new email");
                          }
                          System.out.println("Created new e-mail: " + emailResponse.getObject().getName());
                          
                          // Send e-mail to new subscriber
                          System.out.println("Sending e-mail to subscriber...");
                          ETTriggeredEmail triggeredEmail = new ETTriggeredEmail();
                          triggeredEmail.setClient(etClient);
                          triggeredEmail.setKey("demo-triggered-email");
                          triggeredEmail.setName("demo-triggered-email");
                          triggeredEmail.setEmail(etEmail);
                          SendClassification classification = new SendClassification();
                          classification.setCustomerKey("Default Commercial");
                          triggeredEmail.setSendClassification(classification);
                          ETResponse<ETTriggeredEmail> sendResponse = triggeredEmail.send(subscriber);
                          if(!sendResponse.getResponseCode().equals("OK"))
                          {
                              System.out.println("sendResponse: " + sendResponse.toString());
                              // throw new ETSdkException("** ERROR: could not send e-mail");
                          }
                          System.out.println("Sent e-mail to : " + emailResponse.getObject().getName());
              
                          // Check e-mail status
              
                          // Clean-up
                          System.out.println("Cleaning up...");
                          emailResponse = etClient.delete(etEmail);
                          System.out.println("Deleted e-mail: " + etEmail.getName());
                          subscriberResponse = etClient.delete(subscriber);
                          System.out.println("Deleted subscriber: " + subscriber.getEmailAddress());
                      }
                      catch(ETSdkException e)
                      {
                          System.out.println("** Exception: " + e.toString());
                      }
              
                      System.out.println("All done.\n");
                  }
              }
            </code>
          </pre>
    
          <p class="card-text">Like before, run the command below in a Terminal window to Build the project and create a jar package.</p>
          <pre class="command-line" data-user="sanjay" data-host="MacBook">
            <code class="language-bash">
              mvn clean package
            </code>
          </pre>
  
          <p class="card-text">Run the command below in a Terminal window to run your Java application.</p>
          <pre class="command-line" data-user="sanjay" data-host="MacBook">
            <code class="language-bash">
              mvn exec:java "-Dexec.mainClass=com.sfmcsamples.App"
            </code>
          </pre>
      
          <p class="card-text"><span class="fa fa-star text-success"></span>&nbsp;Congratulations! You have sucessfully created <strong>two</strong> Java apps that use Marketing Cloud.</p>
      </div>
    </div>
</div>

<% include ../partials/footer.ejs %>

</body>
</html>